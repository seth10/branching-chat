<html>
<head>
	<script>
		window.onload = function() {
			document.getElementById("login").onsubmit = function() {
				alert(document.getElementById("passphrase").value);
				return false;
			};
			addChat(3, "AWS", ["Seth: It's pretty cool", "Stuart: yeah!"]);
		};
		function addChat(id, subject, chat) {
			let newChatDiv = document.createElement("div");
			let newChatTitle = document.createElement("h2");
			let newChatMessages = document.createElement("div");
			let newChatForm = document.createElement("form");
			let newChatText = document.createElement("input");
			let newChatSend = document.createElement("input");
			newChatDiv.id = "chat"+id;
			newChatTitle.appendChild(document.createTextNode(subject));
			newChatMessages.className = "messagesContainer";
			newChatText.type = "text";
			newChatText.name = "message";
			newChatSend.type = "submit";
			newChatSend.value = "Send";
			newChatDiv.appendChild(newChatTitle);
			newChatDiv.appendChild(newChatMessages);
			newChatForm.appendChild(newChatText);
			newChatForm.appendChild(newChatSend);
			newChatDiv.appendChild(newChatForm);
			chat.forEach(message => {
				let newMessageP = document.createElement("p");
				newMessageP.appendChild(document.createTextNode(message));
				newChatMessages.appendChild(newMessageP);
			});
			document.getElementById("chats").append(newChatDiv);
			newChatForm.onsubmit = function() {
				alert(newChatText.value);
				return false;
			};
		}
	</script>

	<style>
		body {
			padding: 1em;
		}
		h1 {
			font-family: Sans-Serif;
			font-size: 3em;
		}
		#chats {
			position: absolute;
     		bottom: 1em;
			right: 0;
		}
		#chats > div {
			border: 1px solid grey;
			padding: 0 1em;
			margin: 0 1em;
			float: right;
		}
		div.messagesContainer p {
			margin: 0.2em 0;
		}
	</style>
</head>
<body>
	<h1>branching.chat</h1>

	<form id="login">
		<label>Passphrase: <input type="text" id="passphrase"></label>
		<input type="submit" value="Login">
	</form>

	<div id="chats"></div>
</body>
</html>
